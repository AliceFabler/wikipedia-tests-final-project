package guru.qa.ui.tests;

import io.qameta.allure.*;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Tag;
import org.junit.jupiter.api.Tags;
import org.junit.jupiter.api.Test;

import static io.qameta.allure.Allure.step;

@Epic("Wikipedia (Android)")
@Feature("Search / Поиск")
@Owner("Alice Fabler")
@Tags({@Tag("android"), @Tag("manual"), @Tag("wikipedia")})
@Severity(SeverityLevel.MINOR)
public class SearchTests {

    @Test
    @DisplayName("Поиск: случайный запрос возвращает релевантные результаты")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть главную страницу → сгенерировать случайный запрос → ввести запрос в поиск →
            убедиться, что результаты не пусты и первый результат содержит поисковое слово.
            """)
    @Issue("HOMEWORK-1530")
//    @TmsLink("TMS-SRCH-001")
//    @AllureId("SRCH-001")
    void successfulSearchRemoteTest() {
        // Шаг 1: Открытие главной страницы приложения
        step("Открыть главную страницу приложения");

        // Шаг 2: Генерация случайного запроса для поиска
        step("Генерировать случайный запрос для поиска");

        // Шаг 3: Ввод запроса в поле поиска
        step("Ввести запрос в поле поиска");

        // Шаг 4: Проверка, что результаты поиска не пусты
        step("Проверить, что результаты поиска не пусты");

        // Шаг 5: Проверка, что первый результат содержит поисковое слово
        step("Проверить, что первый результат содержит поисковое слово");
    }

    @Test
    @DisplayName("Поиск: несуществующий запрос даёт пустой результат")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть главную страницу → ввести заведомо несуществующий запрос →
            убедиться, что список результатов пуст.
            """)
    @Issue("HOMEWORK-1531")
//    @TmsLink("TMS-SRCH-002")
//    @AllureId("SRCH-002")
    void searchNoResultsTest() {
        // Шаг 1: Открытие главной страницы приложения
        step("Открыть главную страницу приложения");

        // Шаг 2: Ввод несуществующего запроса в поле поиска
        step("Ввести несуществующий запрос в поле поиска");

        // Шаг 3: Проверка, что результаты поиска пусты
        step("Проверить, что результаты поиска пусты");
    }

    @Test
    @DisplayName("Поиск: пустой запрос не должен показывать результаты")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть главную страницу → оставить поле поиска пустым →
            убедиться, что результаты не отображаются.
            """)
    @Issue("HOMEWORK-1532")
//    @TmsLink("TMS-SRCH-003")
//    @AllureId("SRCH-003")
    void emptySearchQueryTest() {
        // Шаг 1: Открытие главной страницы приложения
        step("Открыть главную страницу приложения");

        // Шаг 2: Оставить поле поиска пустым
        step("Не вводить запрос в поле поиска");

        // Шаг 3: Проверка, что результаты поиска пусты
        step("Проверить, что результаты поиска пусты");
    }

    @Test
    @DisplayName("Поиск: ручной ввод запроса и проверка релевантности")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть страницу поиска → ввести произвольный запрос →
            убедиться, что результаты соответствуют запросу.
            """)
    @Issue("HOMEWORK-1533")
//    @TmsLink("TMS-SRCH-004")
//    @AllureId("SRCH-004")
    void manualSearchTest() {
        // Шаг 1: Открыть страницу поиска
        step("Открыть страницу поиска");

        // Шаг 2: Ввести запрос
        step("Ввести запрос");

        // Шаг 3: Проверить, что результаты поиска соответствуют запросу
        step("Проверить, что результаты поиска соответствуют запросу");
    }

    @Test
    @DisplayName("Поиск: изменение параметров фильтрации отражается в результатах")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть страницу поиска → изменить параметры фильтрации →
            убедиться, что выдача изменилась согласно фильтрам.
            """)
    @Issue("HOMEWORK-1534")
//    @TmsLink("TMS-SRCH-005")
//    @AllureId("SRCH-005")
    void filterSearchTest() {
        // Шаг 1: Открыть страницу поиска
        step("Открыть страницу поиска");

        // Шаг 2: Изменить фильтры поиска
        step("Изменить фильтры поиска");

        // Шаг 3: Проверить, что фильтрация работает корректно
        step("Проверить, что фильтрация работает корректно");
    }

    @Test
    @DisplayName("Поиск: некорректный ввод показывает сообщение об ошибке")
    @Story("Поиск в приложении Wikipedia")
    @Description("""
            Открыть страницу поиска → ввести некорректный запрос →
            убедиться, что отображается сообщение об ошибке.
            """)
    @Issue("HOMEWORK-1535")
//    @TmsLink("TMS-SRCH-006")
//    @AllureId("SRCH-006")
    void invalidSearchTest() {
        // Шаг 1: Открыть страницу поиска
        step("Открыть страницу поиска");

        // Шаг 2: Ввести некорректный запрос
        step("Ввести некорректный запрос");

        // Шаг 3: Проверить, что отображается сообщение об ошибке
        step("Проверить, что отображается сообщение об ошибке");
    }
}
